# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram-–±–æ—Ç–∞ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ Raspberry Pi

## üìã –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

### 1. –°–æ–∑–¥–∞–Ω–∏–µ Telegram-–±–æ—Ç–∞

1. **–û—Ç–∫—Ä–æ–π—Ç–µ Telegram** –∏ –Ω–∞–π–¥–∏—Ç–µ @BotFather
2. **–û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É** `/newbot`
3. **–í–≤–µ–¥–∏—Ç–µ –∏–º—è –±–æ—Ç–∞** (–Ω–∞–ø—Ä–∏–º–µ—Ä, "Raspberry Pi Monitor")
4. **–í–≤–µ–¥–∏—Ç–µ username** (–Ω–∞–ø—Ä–∏–º–µ—Ä, "my_pi_monitor_bot") - –¥–æ–ª–∂–µ–Ω –∑–∞–∫–∞–Ω—á–∏–≤–∞—Ç—å—Å—è –Ω–∞ "bot"
5. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω** - –æ–Ω –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ `123456789:ABCdefGHIjklMNOpqrsTUVwxyz`

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# –û–±–Ω–æ–≤–ª—è–µ–º —Å–∏—Å—Ç–µ–º—É
sudo apt-get update

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Python –∏ pip (–µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã)
sudo apt-get install python3 python3-pip

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É –¥–ª—è Telegram (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Å–ø–æ—Å–æ–±)
sudo apt-get install python3-telegram-bot

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º fswebcam –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–∞–º–µ—Ä–æ–π
sudo apt-get install fswebcam
```

**–ï—Å–ª–∏ –Ω—É–∂–µ–Ω pip (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è):**

```bash
# –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è pip)
sudo apt-get install python3-venv
python3 -m venv ~/telegram_bot_env
source ~/telegram_bot_env/bin/activate
pip install python-telegram-bot

# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞ –∏–∑ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
python telegram_monitor_bot.py
```

**–ï—Å–ª–∏ pip3 install –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–∑-–∑–∞ –æ—à–∏–±–∫–∏ externally-managed-environment:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –≤ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–º –æ–∫—Ä—É–∂–µ–Ω–∏–∏, –ª–∏–±–æ –¥–æ–±–∞–≤—å—Ç–µ —Ñ–ª–∞–≥ --user –∏–ª–∏ --break-system-packages (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):

```bash
pip3 install python-telegram-bot --user
# –∏–ª–∏
pip3 install python-telegram-bot --break-system-packages
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–æ—Ç–∞

1. **–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª** `config.py`
2. **–ó–∞–º–µ–Ω–∏—Ç–µ —Å—Ç—Ä–æ–∫—É** `BOT_TOKEN = "YOUR_BOT_TOKEN_HERE"` –Ω–∞ –≤–∞—à —Ç–æ–∫–µ–Ω:
   ```python
   BOT_TOKEN = "123456789:ABCdefGHIjklMNOpqrsTUVwxyz"
   ```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –¢–æ–∫–µ–Ω —Ç–µ–ø–µ—Ä—å —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ñ–∞–π–ª–µ `config.py` –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–∞–º–µ—Ä—ã

1. **–ü–æ–¥–∫–ª—é—á–∏—Ç–µ USB-–∫–∞–º–µ—Ä—É** –∫ Raspberry Pi
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–∞–º–µ—Ä–∞ –æ–ø—Ä–µ–¥–µ–ª–∏–ª–∞—Å—å**:
   ```bash
   lsusb | grep -i camera
   ```
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞**:
   ```bash
   ls /dev/video*
   ```
4. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ fswebcam**:
   ```bash
   fswebcam -r 1280x720 --no-banner test_photo.jpg
   ```

### 5. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–î–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ —Ç–æ–ª—å–∫–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º:

1. **–ü–æ–ª—É—á–∏—Ç–µ –≤–∞—à ID** –≤ Telegram:
   - –ù–∞–ø–∏—à–∏—Ç–µ –±–æ—Ç—É @userinfobot
   - –û–Ω –ø–æ–∫–∞–∂–µ—Ç –≤–∞—à ID (–Ω–∞–ø—Ä–∏–º–µ—Ä, 123456789)

2. **–î–æ–±–∞–≤—å—Ç–µ ID –≤ —Å–ø–∏—Å–æ–∫ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö** –≤ —Ñ–∞–π–ª–µ `telegram_monitor_bot.py`:
   ```python
   ALLOWED_USERS = [123456789]  # –í–∞—à ID
   ```

### 6. –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞

```bash
# –ó–∞–ø—É—Å–∫ –≤ –æ–±—ã—á–Ω–æ–º —Ä–µ–∂–∏–º–µ
python3 telegram_monitor_bot.py

# –ó–∞–ø—É—Å–∫ –≤ —Ñ–æ–Ω–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
nohup python3 telegram_monitor_bot.py > bot.log 2>&1 &

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã
tail -f bot.log
```

### 7. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. **–ù–∞–π–¥–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞** –≤ Telegram –ø–æ username
2. **–û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É** `/start`
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–º–∞–Ω–¥—É** `/status`
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–º–∞–Ω–¥—É** `/photo`

## üîß –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

- `/start` - –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞ –∏ –ø–æ–∫–∞–∑ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è
- `/status` - –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã (—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, CPU, –ø–∞–º—è—Ç—å, –¥–∏—Å–∫)
- `/photo` - –°–¥–µ–ª–∞—Ç—å –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ —Å –∫–∞–º–µ—Ä—ã
- `/help` - –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω—É—é —Å–ø—Ä–∞–≤–∫—É

## üìä –ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç /status

- **üå°Ô∏è –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ CPU** - —Ç–µ–∫—É—â–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —Å –æ—Ü–µ–Ω–∫–æ–π —Å–æ—Å—Ç–æ—è–Ω–∏—è
- **‚ö° –ó–∞–≥—Ä—É–∑–∫–∞ CPU** - —Å—Ä–µ–¥–Ω—è—è –Ω–∞–≥—Ä—É–∑–∫–∞ –∑–∞ 1, 5 –∏ 15 –º–∏–Ω—É—Ç
- **üß† –ü–∞–º—è—Ç—å** - –æ–±—â–∞—è, –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –∏ –¥–æ—Å—Ç—É–ø–Ω–∞—è –ø–∞–º—è—Ç—å
- **üíæ –î–∏—Å–∫** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã
- **‚è∞ –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã** - —Å–∫–æ–ª—å–∫–æ —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏

## üì∏ –ß—Ç–æ –¥–µ–ª–∞–µ—Ç /photo

- **–î–µ–ª–∞–µ—Ç —Ñ–æ—Ç–æ** —Å USB-–∫–∞–º–µ—Ä—ã —á–µ—Ä–µ–∑ fswebcam
- **–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ**: 1280x720 –ø–∏–∫—Å–µ–ª–µ–π
- **–ö–∞—á–µ—Å—Ç–≤–æ**: 85% JPEG
- **–°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è**: –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç 3 –∫–∞–¥—Ä–∞ –ø–µ—Ä–µ–¥ —Å—ä–µ–º–∫–æ–π
- **–ë–∞–Ω–Ω–µ—Ä**: —É–±–∏—Ä–∞–µ—Ç –¥–∞—Ç—É/–≤—Ä–µ–º—è —Å —Ñ–æ—Ç–æ
- **–ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞**: —É–¥–∞–ª—è–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏

## üö® –°—Ç–∞—Ç—É—Å—ã —Å–∏—Å—Ç–µ–º—ã

- **‚úÖ** - –ù–æ—Ä–º–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- **‚ö†** - –ü–æ–≤—ã—à–µ–Ω–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ (–≤–Ω–∏–º–∞–Ω–∏–µ)
- **‚ùå** - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ (—Ç—Ä–µ–±—É–µ—Ç –¥–µ–π—Å—Ç–≤–∏–π)

## üîÑ –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ

### –°–ø–æ—Å–æ–± 1: systemd —Å–µ—Ä–≤–∏—Å

1. **–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª —Å–µ—Ä–≤–∏—Å–∞**:
```bash
sudo nano /etc/systemd/system/pi-monitor-bot.service
```

2. **–î–æ–±–∞–≤—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ**:
```ini
[Unit]
Description=Raspberry Pi Monitor Telegram Bot
After=network.target

[Service]
Type=simple
User=pi
WorkingDirectory=/home/pi/raspberry_scripts
ExecStart=/usr/bin/python3 /home/pi/raspberry_scripts/telegram_monitor_bot.py
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
```

3. **–ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ —Å–µ—Ä–≤–∏—Å**:
```bash
sudo systemctl daemon-reload
sudo systemctl enable pi-monitor-bot
sudo systemctl start pi-monitor-bot
```

4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å**:
```bash
sudo systemctl status pi-monitor-bot
```

### –°–ø–æ—Å–æ–± 2: crontab

```bash
# –û—Ç–∫—Ä–æ–π—Ç–µ crontab
crontab -e

# –î–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫—É –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
@reboot cd /home/pi/raspberry_scripts && python3 telegram_monitor_bot.py > bot.log 2>&1 &
```

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞ "ModuleNotFoundError: No module named 'telegram'"
- –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ apt: `sudo apt-get install python3-telegram-bot`
- –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ pip: `pip3 install python-telegram-bot --user` –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ

### –û—à–∏–±–∫–∞ "Permission denied"
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ —Ñ–∞–π–ª
chmod +x telegram_monitor_bot.py

# –ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å sudo (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
sudo python3 telegram_monitor_bot.py
```

### –û—à–∏–±–∫–∞ "fswebcam: command not found"
```bash
sudo apt-get install fswebcam
```

### –û—à–∏–±–∫–∞ "No device found" –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ñ–æ—Ç–æ
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–∞–º–µ—Ä—ã: `lsusb | grep -i camera`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞: `ls /dev/video*`
3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∞–≤–∞: `sudo usermod -a -G video pi`
4. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ—Å—å: `sudo reboot`

### –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Ç–æ–∫–µ–Ω–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `tail -f bot.log`

### –û—à–∏–±–∫–∞ –∫–æ–¥–∏—Ä–æ–≤–∫–∏
```bash
export LANG=en_US.UTF-8
python3 telegram_monitor_bot.py
```

## üìà –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ñ–æ—Ç–æ

–í —Ñ—É–Ω–∫—Ü–∏–∏ `take_photo()` –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

```python
# –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ
-r 1920x1080  # Full HD
-r 640x480    # VGA

# –ö–∞—á–µ—Å—Ç–≤–æ JPEG
--jpeg 95     # –í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ
--jpeg 70     # –ù–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ

# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞–¥—Ä–æ–≤ –¥–ª—è —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏
-S 5          # –ë–æ–ª—å—à–µ –∫–∞–¥—Ä–æ–≤ = –ª—É—á—à–µ —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è

# –î–æ–±–∞–≤–∏—Ç—å –±–∞–Ω–Ω–µ—Ä —Å –¥–∞—Ç–æ–π/–≤—Ä–µ–º–µ–Ω–µ–º
# –£–±–µ—Ä–∏—Ç–µ --no-banner –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –±–∞–Ω–Ω–µ—Ä–∞
```

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `tail -f bot.log`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É –∫–∞–º–µ—Ä—ã: `fswebcam test.jpg`
5. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞: `sudo systemctl restart pi-monitor-bot`